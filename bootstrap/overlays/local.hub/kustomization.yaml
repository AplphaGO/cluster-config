apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

helmCharts:
- name: argocd-app-of-app
  version: 0.3.0
  repo: https://gnunn-gitops.github.io/helm-charts
  valuesFile: values.yaml
  namespace: openshift-gitops

resources:
- ../local
#- github.com/gnunn-gitops/cluster-config/bootstrap/overlays/local?ref=6d3a43b61e9dac354b1feb4785e72430d78374bc

patches:
  - target:
      kind: Application
      name: compliance-operator
    patch: |-
      - op: replace
        path: /spec/source/path
        value: 'components/compliance-operator/overlays/cis-compliance-master-only'
      - op: replace
        path: /spec/source/repoURL
        value: 'https://github.com/gnunn-gitops/cluster-config'
 # Patch Applications for commit pinning
  # - target:
  #     kind: Application
  #     labelSelector: repo=cluster-config
  #   patch: |-
  #     - op: replace
  #       path: /spec/source/targetRevision
  #       value: d473880110e912553b46d0071bccec8470f5f747
  # - target:
  #     kind: Application
  #     labelSelector: repo=acm-cluster-hub
  #   patch: |-
  #     - op: replace
  #       path: /spec/source/targetRevision
  #       value: main
  # - target:
  #     kind: Application
  #     labelSelector: repo=gitops-catalog
  #   patch: |-
  #     - op: replace
  #       path: /spec/source/targetRevision
  #       value: main
